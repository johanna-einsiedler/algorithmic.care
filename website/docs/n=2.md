---
toc: false

---
<style>
  body {
     background-color: '#FCE2D0';
  }

  @font-face {
  font-family: "myFirstFont";
  src: url("/Users/htr365/Documents/Side_Projects/09_founding_lab/amanda_johanna/quantified_self.nosync/website/docs/fonts/OpenSauceOne-Black.ttf");
}
</style>

<div class="hero">
<h1> N=2 </h1>
<div id='chart1'></div>
<div id='image'></div>
<path id="arc1" fill="none" stroke="#446688" stroke-width="20" />

</div>

<!-- Load and transform the data -->


```js
import {utcParse} from "npm:d3-time-format";
import * as d3 from "npm:d3";
import {csvFormat} from "d3-dsv";

const parseDate = utcParse("%m/%d/%Y");
const surveyData = FileAttachment("data/data_johanna.csv").csv({typed: true})//.then((D) => D.map(coerceRow));
const EMGData = FileAttachment("data/emg_johanna.csv").csv({typed: true})//.then((D) => D.map(coerceRow));
const annotation = FileAttachment("data/annotation.csv").csv({typed: true})//.then((D) => D.map(coerceRow));

```


```js
// pivot data longer
let data = aq.from(surveyData)                // create an arquero table from our data
    .fold(aq.not('date'), { as: ['name', 'value'] })  // unpivot/fold the data by year, create columns Month and Unemployment
    .objects()

let EMGDataNew= aq.from(EMGData)                // create an arquero table from our data
    .fold(aq.not('date'), { as: ['name', 'value'] })  // unpivot/fold the data by year, create columns Month and Unemployment
    .objects()
// filter only relevant variables
let newData = data.filter(item => Array(
'cis_subjective_fatigue','cis_concentration', 'cis_motivation','cis_physical_activity', 'hooper_stress_level',
'hooper_muscles_sore', 'extra_muscles_tired',
'hooper_sleep_quality','sleep_hours', 'coffee_count', 'alcohol',
'fatigue_prediction','muscles_tired_prediction', 'muscles_sore_prediction',
'step_count',
'1th_col_with_one','2th_col_with_one','3th_col_with_one').includes(item.name));

// define mapping
const categoryMapping = {
  // step count in the middle
    'step_count': 0.1,

  // dots for CIS scale
    //'cis_physical_activity':0.24,
    'cis_concentration': 0.18,
    //'cis_motivation':0.22,
    'cis_physical_activity': 0.20,
    'hooper_stress_level': 0.22,
    'cis_subjective_fatigue': 0.24,
    'fatigue_prediction': 0.24,
  // muscle indicators
    'hooper_muscles_sore': 0.29,
    'muscles_sore_prediction': 0.29,
    'extra_muscles_tired':0.31,
    'muscles_tired_prediction':0.31,

    // sleep data
    'sleep_hours': 0.36,
    'hooper_sleep_quality': 0.36,

    // coffee count
    'coffee_count': 0.4,
    'alcohol': 0.42,

  // EMG data
    'signal_emg': 0.44,
    'emg_envelope': 0.44,
    'signal_mmg': 0.44,

  // activity data
    '1th_col_with_one': 0.49,
    '2th_col_with_one': 0.51,
    '3th_col_with_one': 0.53
  


};

// month Names
const monthNames = ["Jan", "Feb", "Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]
// add new variables to data for image storage and category mapping
const transformedData = newData.map(item => ({
    ...item,
    position: categoryMapping[item.name] || item.name,
    date_formatted:    String(new Date(item.date).getDate()) + '/'+ String(new Date(item.date).getMonth()+1),
    //date: new Date(item.date)
    //image: item.1th_col_with_one "https://raw.githubusercontent.com/johanna-einsiedler/ITU_spring_term_AB_JE/main/website/docs/images/walking.png"
}));

EMGDataNew = EMGDataNew.map(item => ({
    ...item,
    position: categoryMapping[item.name] || item.name,
    //date_formatted:    String(new Date(item.date).getDate()) + '/'+ String(new Date(item.date).getMonth()+1),
    //date: new Date(item.date)
    //image: item.1th_col_with_one "https://raw.githubusercontent.com/johanna-einsiedler/ITU_spring_term_AB_JE/main/website/docs/images/walking.png"
}));

const dictionaryImages = {
  'walking': "https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/walking.png",
  'cycling':"https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/cycling.png",
  'ball_sports': 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/ball_sports.png',
  'manual_work':'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/manual_work.png',
  'running':'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/running.png',
  'weight_lifting': 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/weight_lifting.png',
  'yoga':'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/yoga.png',
  'HITT': 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/HITT.png',
  //'hiking': 'https://raw.githubusercontent.com/johanna-einsiedler/ITU_spring_term_AB_JE/main/website/docs/images/hiking.png'

}

const coffeeImages = {
  1: 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/coffee_bean.png',
  2: 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/coffee_bean_2.png',
  3: 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/coffee_bean_3.png'
}

const alcoholImages = {
  1: 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/alcohol.png',
  2: 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/alcohol_2.png',
  3: 'https://raw.githubusercontent.com/johanna-einsiedler/algorithmic.care/main/website/docs/data/images/alcohol_3.png'
}


// define radial mapping
let longitude = d3.scalePoint(new Set(Plot.valueof(EMGDataNew, "date")), [180, -160]).padding(0.5).align(1)

 const colorScale = {
      'cis_subjective_fatigue': '#B65F77',
      'cis_concentration': '#819E90',
      //'cis_motivation': '#A07ECE',
      'cis_physical_activity': '#2B2D42',
      'hooper_stress_level':'#A07ECE',
      'fatigue_prediction': '#B65F77',
      'hooper_muscles_sore': '#FF914D',
      'muscles_sore_prediction': '#FF914D',
      'extra_muscles_tired': '#854A26',
      'muscles_tired_prediction': '#854A26',
      'signal_emg': '#BDD2C8',
      'emg_envelope': '#819E90',
      'signal_mmg': '#7B7B7B'


    }

const sleepQualityColors = {
  1: '#f4e5ef',
  2: '#dfb2d0',
  3: '#c97eb1',
  4: '#b44b92',
  5: '#813668',
  6: '#4d203e',
  7: '#1a0b15'
}

const niceNames ={
'cis_subjective_fatigue': 'Subjective Fatigue',
'cis_motivation': 'Motivation',
'cis_concentration': 'Concentration',
'cis_physical_activity': 'Productivity',
'hooper_stress_level':'Stress Level',
'hooper_muscles_sore': 'My muscles felt tired',
'extra_muscles_tired': 'My muscles felt sore',
'hooper_sleep_quality': 'Sleep Qualtiy',
'sleep_hours': 'Hours of Sleep'
}

const likertScale = {
    1: 'strongly disagree',
    2: 'disagree',
    3: 'somewhat disagree',
    4: 'neither agree or disagree',
    5: 'somewhat agree',
    6: 'agree',
    7: 'strongly agree'
}

const likertSleep ={
    1: 'very poor',
    2: 'poor',
    3: 'below average',
    4: 'average',
    5: 'above average',
    6: 'good',
    7: 'excellent'
}

function calculateMean(array, property) {
    const sum = array.map(item => item[property]).reduce((acc, current) => acc + current, 0);
    return sum / array.length;
}


// Calculate the mean by dividing the sum by the number of elements
const meansFatigue = ['cis_subjective_fatigue','cis_concentration','cis_physical_activity','hooper_stress_level','cis_motivation'].reduce((acc, column) => {
    acc[column] = calculateMean(surveyData, column);
    return acc;
}, {});

const divisionNull= function(x, y) {
    if(null != x) {
        return x / y
    }
    return null
}

/* 
function curvedText(txt, opts = {}) {
  const {
    path = [
      [0, 0],
      [1, 0]
    ],
    showPath = false,
    fitToPath = false,
    anchor = "middle",
    baseline = "auto",
    fontSize = 10,
    fontFamily = "system-ui",
    fill = "#000000",
    stroke,
    strokeWidth = 0.2,
    letterSpacing = 1,
    wordSpacing = 1
  } = opts;

  const SVG_NS = "http://www.w3.org/2000/svg";
  const TEXT_STYLE =
    "white-space:normal; stroke-linejoin:round; paint-order:stroke";
  const smooth = d3.line().curve(d3.curveCatmullRom);
  const getPathLength = (pathData) => {
    const tempSvg = document.createElementNS(SVG_NS, "svg");
    const tempPath = document.createElementNS(SVG_NS, "path");
    tempPath.setAttribute("d", pathData);
    tempSvg.appendChild(tempPath);
    document.body.appendChild(tempSvg);
    const pathLength = tempPath.getTotalLength();
    document.body.removeChild(tempSvg);
    return pathLength;
  };

  return Plot.text(path, {
    render: (index, scales, { x: X, y: Y }) => {
      const pathData = smooth([...index].map((i) => [X[i], Y[i]]));
      const pathId = document.uid("curve").id;
      const length = fitToPath ? getPathLength(pathData) : null;
      const textAnchor = fitToPath ? "start" : anchor;
      const offset =
        fitToPath || anchor === "start"
          ? "0%"
          : anchor === "end"
          ? "100%"
          : "50%";

      return htl.svg`
        <path
          id="${pathId}"
          fill="none"
          stroke=${showPath ? "red" : "none"}
          stroke-width=1
          stroke-dasharray="4,2"
          d="${pathData}" />
        <text style="${TEXT_STYLE}; fill:${fill}; stroke:${stroke}; stroke-width:${strokeWidth}">
          <textPath
            startOffset="${offset}"
            text-anchor="${textAnchor}"
            dominant-baseline="${baseline}"
            font-family="${fontFamily}"
            font-size=${fontSize}
            textLength=${length || ""}
            word-spacing=${wordSpacing}
            letter-spacing=${letterSpacing}
            href="#${pathId}">
              ${txt}
          </textPath>
        </text>`;
    }
  }); 
}*/


function BubblePlot() {

  return Plot.plot({
  width: 1000,
  projection: {
    type: "azimuthal-equidistant",
   // type: 'band',
    rotate: [0, -90],
    // Note: 0.625Â° corresponds to max. length (here, 0.5), plus enough room for the labels
    domain: d3.geoCircle().center([0, 90]).radius(0.625)(),
    r:[0, 100],
  },
   color: {
    //type: "categorical",
    scheme: "Pastel1",
  },
  x: {label: null, insetLeft: 36, axis: "top", grid:true}, // reserve space for inset labels

  marks: [

    // grey discs
   Plot.geo([0.05, 0.05+5000/300000, 0.05+10000/300000,0.05+15000/300000,0.05+20000/300000,0.18, 0.2, 0.22,0.24,0.29, 0.31, 0.36,0.37], {
      geometry: (r) => d3.geoCircle().center([0, 90]).radius(r)(),
      stroke: "black",
      //fill: "black",
      strokeOpacity: 0.2,
      //fillOpacity: 0.03,
      strokeWidth: 0.5
    }),


    // axes in the middle - short black
    Plot.link(transformedData, {
      x1:({date}) => longitude(date),
      y1: 90 - 0.15,
      x2: ({date}) => longitude(date),
      y2: 90-0.14,
      stroke: "black",
      strokeOpacity: 1,
      strokeWidth: 1
    }),

    // axes outside - lightgrey
    Plot.link(transformedData, {
      x1: ({date}) => longitude(date),
      y1: 90 - 0.48,
      x2: ({date}) => longitude(date),
      y2: 90-0.18,
      stroke: "lightgrey",
      strokeOpacity: 0.5,
      strokeWidth: 1
    }),

   // white part to mark area for annotation
    Plot.lineY(transformedData, {
      x: ({date}) => longitude(date) -34,
      y: ({date}) => longitude(date) <= -110 ? 90-0.5 : 90,
      fill: '#fff9f1',
      type:'cardinal-open',
    }),

       // annotatiion
    Plot.text(annotation, {
      x: ({date}) => longitude(date) ,
      y: ({y}) => 90-y,
      rotate: ({date}) => 180-Number(longitude(date)),
      fill: '#7B7B7B',
      textAnchor: 'end',
      //d: "M 10, 50 a 40,40 0 1,1 80,0 a 40,40 0 1,1 -80,0" ,
      text: ({name}) => name,
      opacity:0.7,
      dx:10 ,
    }), 


    


      // axes labels
   Plot.text(transformedData, {
    x: ({date}) => longitude(date),
    y: 90 - 0.16,
    text: ({date}) =>  monthNames[new Date(date).getMonth()] +' ' + String(new Date(date).getDate()),
    rotate: ({date}) => 180 -Number(longitude(date)),
    lineWidth: 5,
    angel: 90,
    fontFamily: "url(/Users/htr365/Documents/Side_Projects/09_founding_lab/amanda_johanna/quantified_self.nosync/website/docs/fonts/OpenSauceOne-Black.ttf')"
    }),


 /*       // add scale starting line for stepcount
    Plot.lineY(transformedData, {
      x: ({date}) => longitude(date),
      y: 90-0.05,
      stroke:'lightgrey',
      curve: "cardinal",
     }),

  // add scale 5000 line for stepcount
    Plot.lineY(transformedData, {
      x: ({date}) => longitude(date),
      y: 90-0.05-5000/300000,
      stroke:'lightgrey',
      curve: "cardinal",
     }),

      // add scale 10000 line for stepcount
    Plot.lineY(transformedData, {
      x: ({date}) => longitude(date),
      y: 90-0.05-10000/300000,
      stroke:'lightgrey',
      curve: "cardinal",
     }),

        // add scale 15000 line for stepcount
    Plot.lineY(transformedData, {
      x: ({date}) => longitude(date),
      y: 90-0.05-15000/300000,
      stroke:'lightgrey',
      curve: "cardinal",
     }),

           // add scale 20000 line for stepcount
    Plot.lineY(transformedData, {
      x: ({date}) => longitude(date),
      y: 90-0.05-20000/300000,
      stroke:'lightgrey',
      curve: "cardinal-open",
     }),
 */
      // bar chart in the middle for step count
      Plot.link(transformedData.filter(item => Array('step_count').includes(item.name)), {
      x1: ({ date }) => longitude(date),
      x2: ({ date }) => longitude(date),
      y1: ({ position, value }) => 90-0.05-value/300000,
      y2: ({position}) => 90 -0.05,
      strokeWidth: 7,
      stroke:'#7B7B7B',
        title: (d) =>
        `${monthNames[new Date(d.date).getMonth()]} ${new Date(d.date).getDate()} \nStep Count: ${d.value}`,
        tip: true
     }),

  

      // area EMG stats
    //Plot.area(transformedData.filter(item => Array('RMS','IEMG','VAR').includes(item.name)),
     //{x1: ({date}) => longitude(Date.parse(date)), 
      //x2: ({date}) => longitude(Date.parse(date)),
      //y1: ({ position, value }) => 90-position-value/10,
      //y2: ({ position,value }) => 90-position,
      //y2:({ value }) => 90-.2-value/10,
      //y: ({ position }) => 90-Number(position),
      //curve: "cardinal-closed",

     //fillOpacity: 0.3,
     //fill: 'name'}),

        // area EMG stats
    //Plot.lineY(transformedData.filter(item => Array('RMS','IEMG','VAR').includes(item.name)),
     //{x: ({date}) => longitude(Date.parse(date)), 
      //x2: ({date}) => longitude(Date.parse(date)),
      //y: ({ position, value }) => 90-.4-value/10 ,
      //y2: ({ value }) => 90-.38,
      //y2:({ value }) => 90-.2-value/10,
      //y: ({ position }) => 90-Number(position),
      //curve: "cardinal",
      //stroke: 'name'}),
  
   
  // points for CIS scale
    Plot.dot(transformedData.filter(item => Array('cis_subjective_fatigue','cis_concentration', 'hooper_stress_level','cis_physical_activity').includes(item.name)),
     {
      x: ({ date }) => longitude(date), //longitude(date),
      y: ({ position }) => 90-Number(position),
      r: ({value, name}) => null != value ? (1-value/meansFatigue[name])**2:null,
      fill: ({name}) => colorScale[name],
      symbol: 'triangle',
      rotate: ({value,date,name}) => value/meansFatigue[name] < 1 ? 180 -Number(longitude(date))+180 : 180 -Number(longitude(date)),
      opacity: 0.6,
       title: (d) =>
        `${monthNames[new Date(d.date).getMonth()]} ${new Date(d.date).getDate()} | ${niceNames[d.name]} \nScore: ${Math.round(d.value)} | ${Math.round(d.value/meansFatigue[d.name]*100)} % of Mean`, // \n makes a new line
      //stroke: "white",
        tip: true
      //stroke: "white",
    }),

    // plot fatigue prediction
      Plot.dot(transformedData.filter(item => Array('fatigue_prediction').includes(item.name)),
     {
      x: ({ date }) => longitude(date), //longitude(date),
      y: ({ position }) => 90-Number(position),
      r: ({value, name}) => null != value ? (1-value/meansFatigue['cis_subjective_fatigue'])**2:null,
      stroke: ({name}) => colorScale[name],
        symbol: 'triangle',
      rotate: ({value,date,name}) => value/meansFatigue['cis_subjective_fatigue'] < 1 ? 180 -Number(longitude(date))+180 : 180 -Number(longitude(date)),
    }),


      // recatangles for muscle data
    Plot.dot(transformedData.filter(item => Array('hooper_muscles_sore', 'extra_muscles_tired').includes(item.name)),
     {
      x: ({ date }) => longitude(date), //longitude(date),
      y: ({ position }) => 90-Number(position),
      r: ({value}) => value/50,
      fill:({name}) => colorScale[name],
      opacity: 0.6,
      rotate: ({date}) => 180 -Number(longitude(date)) -45,
      symbol: 'square',
         title: (d) =>
        `${monthNames[new Date(d.date).getMonth()]} ${new Date(d.date).getDate()} \n${niceNames[d.name]} : ${likertScale[Math.round(d.value)]} `,
        tip: true
      //stroke: "white",
    }),

         // rectangles for muscle data prediction
    Plot.dot(transformedData.filter(item => Array('muscles_sore_prediction', 'muscles_tired_prediction').includes(item.name)),
     {
      x: ({ date }) => longitude(date), //longitude(date),
      y: ({ position }) => 90-Number(position),
      r: ({value}) => value/50,
      stroke:({name}) => colorScale[name],
      rotate: ({date}) => 180 -Number(longitude(date)) -45,
      symbol:'square',
      
      //stroke: "white",
    }),


         // dots for sleep quality
    Plot.dot(transformedData.filter(item => Array('hooper_sleep_quality').includes(item.name)),
     {
      x: ({ date }) => longitude(date), //longitude(date),
      y: ({ position }) => 90-Number(position),
      r: 10,
      fill:({value}) => sleepQualityColors[value],
      rotate: ({date}) => 180 -Number(longitude(date)),
      //symbol:'triangle',
      opacity: 0.8,
      
      //stroke: "white",
    }),

        // triangles for sleep quality
    Plot.text(transformedData.filter(item => Array('sleep_hours').includes(item.name)),
     {
      x: ({ date }) => longitude(date), //longitude(date),
      y: ({ position }) => 90-Number(position),
      text: 'value',
      rotate: ({date}) => 180 -Number(longitude(date)),
      fill: ({date}) => transformedData.filter(item => Array('hooper_sleep_quality').includes(item.name)).filter(item=>Array(date).includes(item.date))[0].value  <= 4 ? 'black' : 'white',
        title: (d) =>
        `${monthNames[new Date(d.date).getMonth()]} ${new Date(d.date).getDate()} Sleep Duration: ${d.value} hours \nSleep Quality was ${likertSleep[transformedData.filter(item => Array('hooper_sleep_quality').includes(item.name)).filter(item=>Array(d.date).includes(item.date))[0].value]}`,
        tip: true
    }),

      // coffee
    Plot.image(transformedData.filter(item => Array('coffee_count').includes(item.name)), {
      x: ({ date }) => longitude(date),
      y: ({ position }) => 90 - position,
      src: ({ value }) => coffeeImages[value],
      rotate: ({date}) => 180 -Number(longitude(date)),
      width: 15,
    }),

       // alcohol
    Plot.image(transformedData.filter(item => Array('alcohol').includes(item.name)), {
      x: ({ date }) => longitude(date),
      y: ({ position }) => 90 - position,
      src: ({ value }) => alcoholImages[value],
      rotate: ({date}) => 180 -Number(longitude(date)),
      width: 15,
    }),

    // area EMG stats
    Plot.lineY(EMGDataNew.filter(item => Array('signal_emg','emg_envelope','signal_mmg').includes(item.name)),
     {x: ({date}) => longitude(date), 
      y: ({ position, value }) => 90-Number(position) - value/20 ,
    curve: "cardinal-open",
      stroke: ({name}) => colorScale[name]
      }),

    // sports activities
    Plot.image(transformedData.filter(item => Array('1th_col_with_one','2th_col_with_one','3th_col_with_one').includes(item.name)), {
      x: ({ date }) => longitude(date),
      y: ({ position }) => 90 - position,
      src: ({ value }) => dictionaryImages[value],
      rotate: ({date}) => 180 -Number(longitude(date)),

      width: 15,
    }),
    

  


     // white axes
   
    //Plot.dot(data, {x: "date", r: "value", y:'name', fill: "red"})

  ]
})

}


 // points
   // Plot.dot(points, {
     // x: ({ key }) => longitude(key),
     // y: ({ value }) => 90 - value,
      //fill: "name",
      //stroke: "white"
    //}),
display(BubblePlot())


//display(surveyData)
//display(FatiguePlot(surveyData))
function FatiguePlot(data, {width} = {}) {
  return Plot.plot({
    //title: "Experienced Fatigue",
    width,
    marginRight: 100,
    marginLeft: 75,
    marginTop:50,
    //marginRight: 70,
    y: {type: "time", ticks: "day", label: null},
    x: {anchor: 'top'},
    fx: {axis:null},
    fill: {label: null},
    //x: {grid: true, inset: 10, label: "Level of Fatigue", type:"point",domain: [1,2,3,4, 5]},
    height: 700,
    width: 1000,
    //facet: {label: null},
    //y:{grid:true},
    //facet: {marginRight: 79},
    marks: [
        Plot.gridX({strokeDasharray: "2",strokeWidth:1, stroke: '#fcddc9',interval:1, opacity:.5}),
        //Plot.rectX({length: 1}, {y1: 0, y2: 1.4, fill: "red", fillOpacity: 0.3}),
        Plot.axisX({anchor: "top", grid:true}),
        //Plot.text(data, {x: "value", y: "date", text: 'value',fx:'name', dx: 6, lineAnchor: "bottom", rotate:90}),
        //Plot.text(data, {'name', frameAnchor: "top-left", dx: 6, dy: 6}),
        Plot.areaX(data, {
        x: "value",
        fx: "name",
        y: "date",
        fill: '#fcddc9',
        clip: false
      }),
      Plot.text([`How fatigued were you today?`,`Overall how did you feel today?`,`How difficult was it to dress and shower today?`,
        `How difficult was it to climb stairs today?`,`How difficult was it to complete common daily activities?`,
        `How difficult was it to complete common daily activities?`,`Do you have an active and visible rash?`
      ], {
      fx: ["fatigue","wellness","dress_shower","stairs","common","pain","rash"],
      frameAnchor: "top-left",
      lineWidth: 5,
      rotate: 90,
      dx: 12,
      fill: 'black',
      dy: 3,
      lineWidth:300,
    }),
      //Plot.axisFx({ label: null, tickRotate: 90, inset:50, color: 'black'}),

    //Plot.barX(data, {x: "fatigue", y: "steps", fill: "green", dx: -2, dy: -2, facet:"include"})
    //Plot.text(data, Plot.selectLast({x: "date", y: "value", z: "name", text: "name", textAnchor: "start"}))
    ]
  });
}
function correlationPlot(correlations, {width} = {}){
return(Plot.plot({
  x: {tickRotate: -90},
  marginBottom: 200,
  marginLeft: 200,
  width: width,
  label: null,
  color: { scheme: "PRGn", pivot: 0, legend: true, label: "cor" },
  marks: [
    Plot.cell(correlations, { x: "v1", y: "v2", fill: "cor" }),
    Plot.text(correlations, {
      x: "v1",
      y: "v2",
      text: (d) => d.cor.toFixed(2),
      fill: (d) => (Math.abs(d.cor) > 0.6 ? "white" : "black")
    })
  ]
}))
}
//display(correlationPlot(correlations))


// display(Plot.plot({
//   x: {
//     //ticks: simpsons.filter((d) => d.number_in_season === 1).map((d) => d.id),
//     //tickFormat: (x) => simpsons.find((d) => d.id === x).season,
//     label: "Days",
//     labelAnchor: "right",
//     labelArrow: true,
//     tickRotate:-90
//   },
//   color: {
//     type: "linear",
//     scheme: "PiYG"
//   },
//   marks: [
//     Plot.cell(surveyData, {x: "date",fill: "fatigue"})
//   ]
// }))
```
